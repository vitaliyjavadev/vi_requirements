# migration_script

Миграция - скрипт, который вносит изменения в БД или файл, содержащий описание,
как вносить изменения в БД.
Смысл миграций в том, чтобы автоматизировать внесение изменений в БД.

Этот пункт включает требования как к самим скриптам, так и к вносимым изменениям
в схему БД:

1. Скрипты:
    1. **Формат .sql**. При выполнении заданий рассматриваются только миграции в формате sql;
    2. **Наименование скриптов**. Название должно соответствовать шаблону
       `00x_[dml|ddl]_описание.sql`.
       Например, 001_ddl_create_categories_table.sql или
       002_dml_insert_categories.sql;
    3. **Расположение скриптов**. Директория `db` или
       `src/main/resources/db.changelog`;
    4. **Выполнение скриптов**. Исключительно через Liquibase, который нужно
       подключить либо через Spring, либо через Maven плагин;
    5. **Декомпозиция скриптов**. Скрипты не должны быть большими. Изменения
       должны быть логически связанными.
       Например, создание таблицы это отдельный скрипт, ее заполнение еще один
       скрипт, создание другой таблицы еще один скрипт.
2. Изменения:
    1. **text vs varchar(n)**. Вместо `varchar(n)` используйте `varchar` или
       `text`.
       Подробнее [здесь](https://stackoverflow.com/questions/4848964/difference-between-text-and-varchar-character-varying);
    2. **Ограничения**. Ограничения должны быть как можно строже. Чаще всего
       придется указывать `not null` или `unique`.
       Такие ограничения позволят выявить ошибку при сохранении, а не потом;
    3. **Корректность связей**. Тут особых рекомендаций нет. Это зависит от
       разрабатываемого проекта;
    4. **Название таблиц**. У таблиц должен быть единый стиль названия. Если
       используете множественное число `categories`,
       `users` и т.п., то придерживайтесь этих правил. Если именуете в
       единственном числе `category`, `user`, то именуйте все таблицы
       таким образом. 